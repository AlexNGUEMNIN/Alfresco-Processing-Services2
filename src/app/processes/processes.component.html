<div class="processes-container fade-in responsive-processes">
  <!-- Header Section -->
  <div class="processes-header">
    <h2>Process Management</h2>
    <div class="actions">
      <button class="btn-icon refresh-btn" onclick="loadProcesses()">
        <span class="material-icons">refresh</span>
      </button>
    </div>
  </div>

  <!-- Filter Section -->
  <div class="filter-section">
    <div class="search-box">
      <span class="material-icons">search</span>
      <input
        type="text"
        placeholder="Rechercher des processus..."
        id="searchInput"
        oninput="applyFilters()"
      />
    </div>

    <div class="filter-controls">
      <select id="statusFilter" onchange="applyFilters()">
        <option value="">Tous les Statuts</option>
        <option value="active">Actif</option>
        <option value="abandoned">Abandonné</option>
        <option value="terminated">Terminé</option>
      </select>

      <button class="btn-text" onclick="clearFilters()">
        <span class="material-icons">clear</span>
        Effacer Filtres
      </button>
    </div>
  </div>

  <!-- Loading State -->
  <div id="loadingContainer" class="loading-container" style="display: none">
    <div class="loading-spinner"></div>
    <p>Chargement des processus...</p>
  </div>

  <!-- Table Container -->
  <mat-form-field>
    <input
      matInput
      (keyup)="applyFilter($any($event.target).value)"
      placeholder="Filter"
    />
  </mat-form-field>

  <div class="mat-elevation-z8">
    <table mat-table [dataSource]="dataSource" matSort>
      <!-- ID Column -->
      <ng-container matColumnDef="id">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>ID</th>
        <td mat-cell *matCellDef="let row">{{ row.id }}</td>
      </ng-container>

      <!-- Progress Column -->
      <ng-container matColumnDef="progress">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Progress</th>
        <td mat-cell *matCellDef="let row">{{ row.progress }}%</td>
      </ng-container>

      <!-- Name Column -->
      <ng-container matColumnDef="name">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Name</th>
        <td mat-cell *matCellDef="let row">{{ row.name }}</td>
      </ng-container>

      <!-- Color Column -->
      <ng-container matColumnDef="color">
        <th mat-header-cell *matHeaderCellDef mat-sort-header>Color</th>
        <td mat-cell *matCellDef="let row" [style.color]="row.color">
          {{ row.color }}
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <tr mat-row *matRowDef="let row; columns: displayedColumns"></tr>
    </table>

    <mat-paginator [pageSizeOptions]="[5, 10, 25, 100]"></mat-paginator>
  </div>

  <!-- Empty State -->
  <div id="emptyState" class="empty-state" style="display: none">
    <span class="material-icons">find_in_page</span>
    <p>Aucun processus trouvé correspondant à vos critères.</p>
    <button class="btn btn-primary" onclick="clearFilters()">
      Effacer les Filtres
    </button>
  </div>

  <!-- Process Details Panel -->
  <div
    id="processDetailsPanel"
    class="process-details-panel slide-in-left"
    style="display: none"
  >
    <div class="panel-header">
      <h3>Détails du Processus</h3>
      <button class="btn-icon" onclick="closeProcessDetails()">
        <span class="material-icons">close</span>
      </button>
    </div>

    <div class="panel-content">
      <div class="detail-section">
        <h4>Informations de Base</h4>
        <div class="detail-row">
          <span class="label">ID:</span>
          <span class="value" id="detailId">-</span>
        </div>
        <div class="detail-row">
          <span class="label">Nom:</span>
          <span class="value" id="detailName">-</span>
        </div>
        <div class="detail-row">
          <span class="label">Type:</span>
          <span class="value" id="detailType">-</span>
        </div>
        <div class="detail-row">
          <span class="label">Statut:</span>
          <span class="badge" id="detailStatus">-</span>
        </div>
        <div class="detail-row">
          <span class="label">Date de Début:</span>
          <span class="value" id="detailStartDate">-</span>
        </div>
        <div class="detail-row">
          <span class="label">Dernière Activité:</span>
          <span class="value" id="detailLastActivity">-</span>
        </div>
      </div>

      <div class="detail-section">
        <h4>Timeline</h4>
        <div class="timeline-placeholder">
          <p>La visualisation de la timeline du processus apparaîtra ici</p>
        </div>
      </div>

      <div class="detail-section">
        <h4>Variables</h4>
        <div class="variables-placeholder">
          <p>Les variables du processus apparaîtront ici</p>
        </div>
      </div>

      <div class="action-buttons">
        <button
          class="btn btn-primary"
          id="restartBtn"
          onclick="restartSelectedProcess()"
          style="display: none"
        >
          <span class="material-icons">play_circle</span>
          Redémarrer Processus
        </button>

        <button
          class="btn btn-error"
          id="terminateBtn"
          onclick="terminateSelectedProcess()"
          style="display: none"
        >
          <span class="material-icons">stop_circle</span>
          Terminer Processus
        </button>
      </div>
    </div>
  </div>
</div>
<style>
  /* Responsive styles for processes */
  .responsive-processes {
    padding: 2rem;
  }
  @media (max-width: 1200px) {
    .responsive-processes {
      padding: 1rem;
    }
    .filter-section {
      flex-direction: column;
      gap: 1rem;
    }
  }
  @media (max-width: 900px) {
    .processes-header {
      flex-direction: column;
      align-items: flex-start;
      gap: 1rem;
    }
    .filter-section {
      flex-direction: column;
      align-items: stretch;
      gap: 1rem;
    }
  }
  @media (max-width: 768px) {
    .responsive-processes {
      padding: 0.5rem;
    }
    .processes-header {
      flex-direction: column;
      align-items: flex-start;
      gap: 0.5rem;
    }
    .filter-section {
      flex-direction: column;
      gap: 0.5rem;
    }
    .responsive-table-container {
      overflow-x: auto;
    }
    table,
    thead,
    tbody,
    th,
    td,
    tr {
      display: block;
      width: 100%;
    }
    thead {
      display: none;
    }
    tr {
      margin-bottom: 1rem;
      border-bottom: 1px solid #eee;
      background: #fff;
    }
    td {
      text-align: right;
      padding-left: 50%;
      position: relative;
      min-height: 2.5rem;
      box-sizing: border-box;
    }
    td:before {
      position: absolute;
      left: 0;
      width: 50%;
      padding-left: 1rem;
      white-space: nowrap;
      font-weight: bold;
      text-align: left;
      content: attr(data-label);
      color: #333;
    }
    .action-buttons {
      justify-content: flex-end;
    }
    .process-details-panel {
      width: 100vw !important;
      left: 0 !important;
      border-radius: 0 !important;
      max-width: 100vw !important;
    }
  }
  @media (max-width: 480px) {
    .responsive-processes {
      padding: 0.2rem;
    }
    .processes-header h2 {
      font-size: 1.2rem;
    }
    .filter-section input,
    .filter-section select {
      font-size: 0.95rem;
    }
    .action-buttons button {
      min-width: 32px;
      min-height: 32px;
      font-size: 1.1rem;
    }
  }
</style>
